---
title: "Natural Language Processing with Moz and Cave: Sentiment Analysis"
author: "Hilary Dotson"
date: "Updated December 6, 2020"
output: 
  rmarkdown::github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
library(gridExtra)
library(magrittr)
library(readr)
library(stringr)
library(tidytext)

```

# Introduction

As a sociologist by training with a background in both quantitative and quantitative methods, I have been curious about what natural language processing can do (and *can't* do) to inform the social word.  I have some excellent colleagues who are great with MLP, and I'd like to have a better understanding of the kinds of work they do. 

In reading through publicly available information on natural language processing, I found Silge and Robinson's text, *[Text Mining with R: A Tidy Approach](https://www.tidytextmining.com/)*, where the authors work through several elementary examples to help readers grasp how to use R to conduct sentiment analysis, analyze word and document frequencies, and conduct topic modeling, primarily by using old books (both fiction and non-fiction). Cool stuff.

So, it would be fun to do something similar But, as some of you might now, I spent many years cultivating an interesting/unique/little strange taste in music. And two of my favorite artists are [Nick Cave](https://en.wikipedia.org/wiki/Nick_Cave) and [Morrissey](https://en.wikipedia.org/wiki/Morrissey). I've seen both perform live in the last few years and those are two major highlights of my life (say what you will about what that means about me). And as a heavily tattooed woman, two of my tattoos are of them.  So, clearly influential to some degree.

So who are Nick Cave and Steven Patrick Morrissey? Let's just talk about their commonalities. Both are around 60 years old. Both have careers spanning 35+ years. Both have been involved in at least one other major project besides their current work (Morrissey as the front-man of The Smiths; Nick Cave in The Boys Next Door, The Birthday Party, and Grinderman). Both are still active musicians and have achieved success across mainstream audiences, despite their more niche roots in the 1970s and 1980s. 

Both are a little weird, a little dark, and  vegetarians/vegans -- so we have a lot in common (in my head, at least).  Though, I'll certainly distance myself from one of their political beliefs.  You can guess which one.

# Why Bring NLP to Morrissey and Nick Cave?

Well for one, because both would probably dislike it. Maybe they'll write songs about it. 

Seriously though, I thought it would be fun to do a very basic sentiment analysis using their songs. *In the coming weeks, I'll perform topic modeling on the same corpus--stay tuned.*

From my personal take, Morrissey tends to write songs that are sad, witty, and sound much happier when performed than when read. And in my read, Nick Cave tends to write tragic stories in songs, which sound sad when performed and read. Morrissey's lyrics are imbued with literature, politics, and opinion; Nick Cave's with religious imagery, love, and death.

And since this is just for fun, I figured I'd settle the debate I've had internally for 15+ years once and for all: 

**Who's gloomier? Morrissey or Nick Cave?**

In support of this effort, **I'll test a hypothesis using sentiment analysis.** My hypothesis is that *Nick Cave's songs will be more negative, in general, than Morrissey's.* 

I will mostly be following along with the process detailed by Silge and Robinson in *Tidy Text Mining*. 

# Objectives

* Successfully create a catalog of songs that includes a unique ID, artist name, album name, song name, and lyrics for each song.
* Import .csv file into R which contains song lyrics for the selected songs. 
* Completely some very basic data cleaning for text analysis.
* Conduct a rudimentary sentiment analysis on the two artists' songs.

# Data 

I manually created a .csv file that contained all the songs and lyrics from both artists' studio album discographies (excluding albums that only included covers). Note that I did not QC the lyrics and took them as they appeared on available lyric websites. At some point, I'll do a similar project using webscraping to collect the data. *Note that the lyrics are property of their owners, not not not me.*

Nick Cave and The Bad Seeds have 16 studio albums that met the aforementioned criteria, containing a total of 160 songs. Morrissey has 12 studio solo albums, containing a total of 132 songs. Note that not all songs were written by Cave and Morrissey, respectively, though nearly all were.  Certainly a project for another day, though.


```{r import, warning=FALSE}
songlist <- readr::read_csv("moz_cave_songlist.csv")
colnames(songlist)
```

Just to get an idea as to what the lyrics wind up looking like, let's take a look at the 149th row's song lyrics (Nick Cave and the Bad Seeds - Skeleton Tree).  Yes, I deliberately picked it.

```{r}
# Wrapping the songlist object with as.data.frame so the entire lyrics print.  
# Since the songlist object is a tibble, it otherwise would only print the
# first few words.

as.data.frame(songlist[149,5])
```
Those are the full lyrics to the song.  You'll notice indications of line breaks ("\\n"), words starting with uppercase characters, and other forms of punctuation. So, we need to clean this up.

# Basic Data Cleaning 

From here, I used dplyr and tidytext packages to do some basic data cleaning and transformation. 

First, I transformed the data set so that each observation corresponds to a singular word, rather than an entire song: 

```{r tidying, warning=FALSE, message=FALSE}
tidy_songlist <- songlist %>%
    tidytext::unnest_tokens(word, lyrics)

head(tidy_songlist)
str(tidy_songlist)
``` 

As we can see, the tidy_songlist data set contains 68,988 words. 

Next, I looked at the most frequently occurring words to help inform decisions on removing stopwords.

```{r counts}
tidy_songlist %>%
  dplyr::count(word, sort = TRUE)
```

Words like these top ones (articles, pronouns, etc.) are probably safe to remove. Notice that there are 6,458 unique words in these data. Let's remove them and see what we are left with.

```{r stopwords, warning=FALSE}
tidy_rm_stopwords <- tidy_songlist %>%
  dplyr::anti_join(stop_words)

head(tidy_rm_stopwords)
str(tidy_rm_stopwords)

tidy_rm_stopwords %>%
  count(word, sort = TRUE)

```

Removing the stopwords reduced the total word count to 23,873 and the number of unique words to 5,931. 

For fun, let's look at all the lyrics in the song Skeleton Tree again -- in both the tidy_songlist version of the corpus, and the version where we removed stopwords. 
```{r}

print(tidy_songlist %>%
  dplyr::filter(song_name == "Skeleton Tree") %>%
    dplyr::select(word), 
  n = Inf) 

print(tidy_rm_stopwords %>%
  dplyr::filter(song_name == "Skeleton Tree") %>%
    dplyr::select(word), 
  n = Inf) 
```

The complete song contains 106 words, while the version with stopwords removed contains only 43.  More importantly, the flow is completely off in the second version!  However, the version without stopwords is much more appropriate for NLP.  So, we continue.

# Splitting the Data

From here, I created two subsets of the data; one for Nick Cave and the Bad Seeds songs (tidy_nickcave) and one for just Morrissey songs (tidy_moz).


```{r split} 
# Nick Cave and the Bad Seeds transformation and summary
tidy_nickcave <- dplyr::filter(tidy_rm_stopwords, artist == "Nick Cave & The Bad Seeds")

head(tidy_nickcave)
str(tidy_nickcave)
tidy_nickcave %>%
  dplyr::count(word, sort = TRUE)

unique_tidy_nickcave <- tidy_nickcave %>%
  dplyr::count(word, sort = TRUE)

n_unique_tidy_nickcave <- nrow(unique_tidy_nickcave)
tot_tidy_nickcave <- nrow(tidy_nickcave)


# Morrissey transformation and summary
tidy_moz <- dplyr::filter(tidy_rm_stopwords, artist == "Morrissey")

head(tidy_moz)
str(tidy_moz)
tidy_moz %>%
  dplyr::count(word, sort = TRUE)

unique_tidy_moz <- tidy_moz %>%
  dplyr::count(word, sort = TRUE)

n_unique_tidy_moz <- nrow(unique_tidy_moz)
tot_tidy_moz <- nrow(tidy_moz)
```

Notice that with stopwords removed, Nick Cave uses more than twice as many unique words in his songs, compared to Morrissey (`r n_unique_tidy_nickcave` vs. `r n_unique_tidy_moz`). Nick Cave also uses almost three times as many non-stopword words in his lyrics, overall, compared to Morrissey (`r tot_tidy_nickcave` vs. `r tot_tidy_moz`). 

# Sentiment Analysis
The tidytext package comes with three sentiment dictionaries: AFINN, Bing, and NRC. The Bing lexicon is the most simplistic of the three; it assigns sentiments of either "positive" or "negative" to a list of about ~6,800 words. For the purposes of this exercise, I'll use the Bing lexicon. *Later on, I might compare the three just to see, but that will be for another day.* 

```{r sentiments}
bing_sent <- tidytext::get_sentiments("bing")

# Nick Cave and the Bad Seeds 
tidy_nickcave_bing <- tidy_nickcave %>%
  dplyr::inner_join(bing_sent) %>%
  dplyr::mutate(method = "Bing et al.")

# Proportion positive/negative sentiment for NicK Cave & The Bad Seeds
tidy_nickcave_bing %>%
  dplyr::count(sentiment, sort = TRUE) %>%
  dplyr::mutate(prop = n / sum(n))

per_sent_nickcave <- (round(nrow(tidy_nickcave_bing)/nrow(tidy_nickcave), digits = 3)*100)

# Morrissey
tidy_moz_bing <- tidy_moz %>%
  dplyr::inner_join(bing_sent) %>%
  dplyr::mutate(method = "Bing et al.")

# Proportion positive/negative sentiment for NicK Cave & The Bad Seeds
tidy_moz_bing %>%
  dplyr::count(sentiment, sort = TRUE) %>%
  dplyr::mutate(prop = n / sum(n))

per_sent_moz <- (round(nrow(tidy_moz_bing)/nrow(tidy_moz), digits = 3)*100)

```

A few points to keep in mind:

* Less than one-quarter (`r per_sent_moz`) of Morrissey's non-stopword lyrics had any sentiment.
* Only `r per_sent_nickcave` of Nick Cave's non-stopword lyrics had any sentiment. 

From here, let's take a look at each artist's most commonly used words, and the sentiment applied to each: 

```{r sent counts}
# Nick Cave and the Bad Seeds
tidy_nickcave_bing_counts <- tidy_nickcave_bing %>%
  dplyr::count(word, sentiment, sort = TRUE) %>%
  dplyr::ungroup() 

tidy_nickcave_bing_counts

# Morrissey
tidy_moz_bing_counts <- tidy_moz_bing %>%
  dplyr::count(word, sentiment, sort = TRUE) %>%
  dplyr::ungroup() 

tidy_moz_bing_counts 
```

For both artists, the word "love" was the most commonly used word and the only word with positive sentiment. Adorable! 

At this point, it's helpful to consider the percentage of negative v. positive sentiment words in both corpi. 

```{r}
tidy_nickcave_bing_counts %<>%
  dplyr::mutate(sentiment_binary = case_when(
    sentiment == "positive" ~ 1, 
    sentiment == "negative" ~ 0
  )) %>%
  dplyr::relocate(sentiment_binary, .after = sentiment)

mean_nickcave_pos <- (round(mean(tidy_nickcave_bing_counts$sentiment_binary), 
                            digits = 3)*100)

tidy_moz_bing_counts %<>%
  dplyr::mutate(sentiment_binary = case_when(
    sentiment == "positive" ~ 1, 
    sentiment == "negative" ~ 0
  )) %>%
  dplyr::relocate(sentiment_binary, .after = sentiment)


mean_moz_pos <- (round(mean(tidy_moz_bing_counts$sentiment_binary), 
                            digits = 3)*100)

```

About one-quarter of Nick Cave's non-stopword lyrics had positive sentiment (`r mean_nickcave_pos`), compared to shy of one-third for Morrissey (`r mean_moz_pos`). Hmph!

# Visualizing Sentiment
At this point, let's visually compare the two and settle this once and for all (until one of them comes out with another album).

```{r sent plots, echo = FALSE, message = FALSE, warning = FALSE}
nickcave_viz <- tidy_nickcave_bing_counts %>%
  dplyr::group_by(sentiment) %>%
  dplyr::top_n(10) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(word = reorder(word, n)) %>%
  ggplot2::ggplot(aes(word, n, fill = sentiment)) +
  ggplot2::geom_col(show.legend = FALSE) +
  ggplot2::facet_wrap(~sentiment, scales = "free_y") +
  ggplot2::ylim(0, 250) + 
  ggplot2::labs(x = "Nick Cave Top 10 Sentiment Words",
     y = NULL) +
  ggplot2::coord_flip()

moz_viz <- tidy_moz_bing_counts %>%
  dplyr::group_by(sentiment) %>%
  dplyr::top_n(10) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(word = reorder(word, n)) %>%
  ggplot2::ggplot(aes(word, n, fill = sentiment)) +
  ggplot2::geom_col(show.legend = FALSE) +
  ggplot2::facet_wrap(~sentiment, scales = "free_y") +
  ggplot2::ylim(0, 250) + 
  ggplot2::labs(x = "Morrissey Top 10 Sentiment Words",
       y = NULL) +
  ggplot2::coord_flip()


gridExtra::grid.arrange(nickcave_viz, moz_viz)
```

# Conclusion 

Look at all that love! And just how similar the sentiment holding words are for both artists!  That said though, it's evident both from the graphs and summary statistics that the sentiment of Nick Cave's lyrics is more negative than Morrissey's.  Context is important though.  Any listener of Morrissey can tell you that when he refers to love or is singing of love, he's primarily discussing unrequited love or the fact (?) that he has never experienced love -- not exactly a happy story.  While with Nick Cave, the love "feels" more positive.  If I had used more than unigrams in this study, perhaps that would have emerged more organically.

Overall though, these findings are consistent with what I thought would happen going into it.  Many of Nick Cave's older songs are epic stories involving death.  And in his more recent music, he tackles enormous grief and loss in his songs.  


